class Cart{constructor(t,a){this.source=t,this.container=a,this.countGoods=0,this.amount=0,this.cartItems=[],this._init()}_init(){fetch(this.source).then(t=>t.json()).then(t=>{for(let a of t.contents)this.cartItems.push(a),this._renderItem(a);this.countGoods=t.countGoods,this.amount=t.amount,this._renderSum()})}_renderItem(t){let a=$("<div/>",{class:"cart-drop-product","data-product":t.id_product});a.append($(`<img class="cart-drop-img" src="${t.product_img}" alt="img_product">`));let s=$("<div/>",{class:"cart-drop-details"});s.append($(`<a class="cart-drop-details-name" href="#">${t.product_name}</a>`)),s.append($(`<p class="cart-drop-details-comment">${t.product_rating}</p>`)),s.append($(`<span class="cart-drop-details-quantity">${t.quantity}</span>`)),s.append($('<span class="cart-drop-details-factor"> x </span>')),s.append($(`<span class="cart-drop-details-price">$${t.price.toFixed(2)}</span>`));let d=$('<button class="cart-drop-details-delBtn">&#10005;</button>');d.click(()=>{this._remove(t.id_product)}),a.append(s),a.append(d),a.appendTo(this.container)}_renderSum(){$(".header-cart-count_goods").text(`${this.countGoods}`),$(".cart-drop-total-value").text(`$${this.amount.toFixed(2)}`)}_updateCart(t){$(`div[data-product="${t.id_product}"]`).find(".cart-drop-details-quantity").text(t.quantity)}addProduct(t){let a=+$(t).data("id"),s=this.cartItems.find(t=>t.id_product===a);if(s)s.quantity++,this.countGoods++,this.amount+=s.price,this._updateCart(s);else{let a={id_product:+$(t).data("id"),product_img:$(t).data("img"),product_name:$(t).data("name"),product_rating:$(t).data("rating"),price:+$(t).data("price"),quantity:1};this.cartItems.push(a),console.log(this.cartItems),this._renderItem(a),this.amount+=a.price,this.countGoods+=a.quantity}this._renderSum()}_remove(t){let a=this.cartItems.find(a=>a.id_product===t);this.cartItems.splice(this.cartItems.indexOf(a),1),$(`div[data-product="${t}"]`).remove(),this.amount-=a.price*a.quantity,this.countGoods-=a.quantity,this._renderSum(),console.log(this.cartItems)}}