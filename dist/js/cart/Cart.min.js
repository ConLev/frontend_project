class Cart{constructor(t,a){this.source=t,this.container=a,this.cartId=0,this.countGoods=0,this.amount=0,this.cartItems=[],this._init()}_init(){this._render(),fetch(this.source).then(t=>t.json()).then(t=>{for(let a of t.items)this.cartItems.push(a),this._renderItem(a);this.cartId=t.cartId,this.countGoods=t.countGoods,this.amount=t.amount,this._renderSum()})}_render(){let t=$("<div/>",{class:"products-box"}),a=$("<div/>",{class:"products-box-header"});a.append($("<span>Product Details</span>")),a.append($('<span class="unite-price-header">unite Price</span>')),a.append($('<span class="quantity-header">Quantity</span>')),a.append($('<span class="shipping-header">shipping</span>')),a.append($('<span class="subtotal-header">Subtotal</span>')),a.append($('<span class="action-header">ACTION</span>'));let s=$("<div/>",{class:"shopping-cart-button container"}),e=$('<button class="shopping-cart-button_clear">CLEAR SHOPPING CART</button>');e.click(()=>{this.cartItems=[],$(".header-cart-count_goods").text("0"),$(".shopping-cart_container").empty()}),s.append(e),s.append($('<button class="shopping-cart-button_continue">CONTINUE SHOPPING</button>')),a.appendTo(t),t.appendTo($(this.container)),s.appendTo($(this.container))}_renderItem(t){let a=$("<div/>",{class:"product-box-details","data-product":t.id_product});a.append($(`<img src="${t.product_img}" alt="product_photo">`));let s=$("<div/>",{class:"product-details-box_parameter"});s.append($(`<a class="product-details-link" href="#">${t.product_name}</a>`));let e=$("<div/>",{class:"box-details-comment"});e.append($(`<span class="product-details-comment">${t.product_rating}</span>`)),s.append(e);let p=$("<div/>",{class:"product-details-color"});p.append($('<span class="product-details-parameter">Color:</span>')),p.append($(`<span class="product-details-value">${t.product_color}</span>`)),s.append(p);let n=$("<div/>",{class:"product-details-size"});n.append($('<span class="product-details-parameter">Size:</span>')),n.append($(`<span class="product-details-value">${t.product_size}</span>`)),s.append(n),a.append(s);let d=$("<div/>",{class:"cart-product-price"});d.append($(`<span class="cart-product-value_text">$${t.price}</span>`)),a.append(d);let c=$("<label/>",{class:"cart-product-quantity"}),i=$('<input class="cart-quantity-value" type="number" min="1"</input>');i.val(+t.quantity),i.on("keydown paste",t=>{t.preventDefault()}),i.click(()=>{this._updateQuantity(t.id_product,i.val())}),c.append(i),a.append(c);let o=$("<div/>",{class:"cart-product-shipping"});o.append($(`<span class="cart-product-value_text">${t.product_shipping}</span>`)),a.append(o);let r=$("<div/>",{class:"cart-product-subtotal"});r.append($(`<span class="cart-product-subtotal_value">$${t.price*t.quantity}</span>`)),a.append(r);let u=$("<div/>",{class:"cart-product-action"}),l=$('<button class="cart-product-remBtn">&#10005;</button>');l.click(()=>{this._remove(t.id_product)}),u.append(l),a.append(u),a.appendTo($(".products-box"))}_renderSum(){$(".sub-total-value").text(`$${this.amount}`),$(".grand-total-value").text(`$${this.amount}`),$(".header-cart-count_goods").text(`${this.countGoods}`)}_updateCart(t){$(`div[data-product="${t.id_product}"]`).find(".cart-product-subtotal_value").text(`$${t.price*t.quantity}`)}_updateQuantity(t,a){let s=this.cartItems.find(a=>a.id_product===t);s.quantity<a?(s.quantity=a,this.countGoods++,this.amount+=s.price,this._updateCart(s)):s.quantity>a&&(s.quantity=a,this.countGoods--,this.amount-=s.price,this._updateCart(s)),this._renderSum()}_remove(t){let a=this.cartItems.find(a=>a.id_product===t);this.cartItems.splice(this.cartItems.indexOf(a),1),$(`div[data-product="${t}"]`).remove(),this.amount-=a.price*a.quantity,this.countGoods-=a.quantity,this._renderSum()}}